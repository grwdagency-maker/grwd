<!DOCTYPE HTML>
<html>
	<head>
		<title>GRWD | Growth Audit Protocol</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Outfit:wght@400;600;800&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
		<link rel="stylesheet" href="assets/css/main.css" />
        
        <style>
            /* === QUIZ ENGINE STYLES === */

            /* 1. LAYOUT ENGINE (Flexbox Footer Fix) */
            #wrapper {
                display: flex;
                flex-direction: column;
                min-height: 100vh;
                margin-left: 260px; /* Sidebar offset */
            }

            .quiz-wrapper {
                flex: 1; 
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                padding: 60px 20px;
            }

            /* 2. CONTAINER DESIGN */
            .quiz-container {
                background: rgba(10, 14, 20, 0.7);
                backdrop-filter: blur(20px);
                -webkit-backdrop-filter: blur(20px);
                border: 1px solid rgba(255, 255, 255, 0.08);
                width: 100%;
                max-width: 700px;
                border-radius: 12px;
                box-shadow: 0 30px 60px rgba(0,0,0,0.6);
                position: relative;
                overflow: hidden;
                padding: 50px;
            }

            .quiz-container::before {
                content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 2px;
                background: linear-gradient(90deg, transparent, var(--accent-cyan), transparent);
                box-shadow: 0 0 15px var(--accent-cyan);
            }

            /* 3. PROGRESS BAR */
            .progress-container {
                width: 100%;
                background: rgba(255,255,255,0.05);
                height: 4px;
                border-radius: 2px;
                margin-bottom: 30px;
                overflow: hidden;
                display: flex;
            }
            .progress-fill {
                height: 100%;
                background: var(--accent-cyan);
                width: 0%;
                transition: 0.5s cubic-bezier(0.22, 1, 0.36, 1);
                box-shadow: 0 0 10px var(--accent-cyan);
            }

            /* 4. TYPOGRAPHY */
            .section-label {
                font-family: 'Outfit', sans-serif;
                font-size: 11px;
                color: var(--accent-cyan);
                text-transform: uppercase;
                letter-spacing: 0.2em;
                margin-bottom: 10px;
                display: block;
                opacity: 0.9;
            }
            h2#question {
                font-family: 'Outfit', sans-serif;
                color: #fff;
                font-size: 24px;
                font-weight: 600;
                margin-bottom: 15px;
                line-height: 1.3;
            }
            .hint {
                color: #888;
                font-size: 14px;
                display: block;
                margin-bottom: 30px;
                font-style: italic;
            }

            /* 5. OPTIONS & INPUTS */
            .option {
                background: rgba(255,255,255,0.02);
                border: 1px solid rgba(255,255,255,0.08);
                padding: 16px 20px;
                border-radius: 8px;
                margin-bottom: 12px;
                cursor: pointer;
                transition: all 0.2s ease-out;
                display: flex;
                align-items: center;
                color: #ccc;
                font-size: 15px;
                line-height: 1.5;
            }
            .option:hover {
                background: rgba(255,255,255,0.05);
                border-color: rgba(255,255,255,0.2);
                color: #fff;
                transform: translateX(4px);
            }
            .option.selected {
                background: rgba(0, 240, 255, 0.08);
                border-color: var(--accent-cyan);
                color: #fff;
                box-shadow: 0 0 20px rgba(0, 240, 255, 0.05);
            }

            /* Indicators */
            .indicator {
                width: 18px; height: 18px;
                border: 2px solid #555;
                border-radius: 50%;
                margin-right: 15px;
                display: flex; align-items: center; justify-content: center;
                flex-shrink: 0;
                transition: 0.2s;
            }
            .multiple .indicator { border-radius: 3px; } 
            .option.selected .indicator {
                border-color: var(--accent-cyan);
                background: var(--accent-cyan);
                box-shadow: 0 0 10px var(--accent-cyan);
            }

            /* Inputs */
            .custom-input {
                background: transparent;
                border: none;
                border-bottom: 1px solid #555;
                color: #fff;
                font-family: 'Inter', sans-serif;
                font-size: 15px;
                padding: 5px 0;
                width: 100%;
                outline: none;
                transition: 0.3s;
                margin-left: 10px;
            }
            .custom-input:focus { border-bottom-color: var(--accent-cyan); }
            /* Standalone input option */
            .input-only-option { cursor: default; }
            .input-only-option:hover { transform: none; background: rgba(255,255,255,0.02); }

            /* 6. NAVIGATION BUTTONS */
            .nav-actions {
                display: flex;
                gap: 15px;
                margin-top: 35px;
            }
            
            .btn-action {
                flex: 1;
                background: transparent;
                border: 1px solid #333;
                color: #555;
                padding: 18px;
                text-transform: uppercase;
                letter-spacing: 0.15em;
                font-weight: 700;
                cursor: not-allowed;
                transition: all 0.3s;
                border-radius: 4px;
                font-size: 13px;
            }
            
            /* Next Button Active State */
            #next-btn:not(:disabled) {
                border-color: var(--accent-cyan);
                color: var(--accent-cyan);
                background: rgba(0, 240, 255, 0.05);
                cursor: pointer;
                box-shadow: 0 0 20px rgba(0, 240, 255, 0.1);
            }
            #next-btn:not(:disabled):hover {
                background: var(--accent-cyan);
                color: #050505;
                box-shadow: 0 0 40px rgba(0, 240, 255, 0.4);
            }

            /* Back Button */
            #back-btn {
                flex: 0 0 100px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —à–∏—Ä–∏–Ω–∞ */
                border-color: #444;
                color: #888;
                cursor: pointer;
                display: none; /* –°–∫—Ä—ã—Ç –Ω–∞ —Å—Ç–∞—Ä—Ç–µ */
            }
            #back-btn:hover {
                border-color: #666;
                color: #fff;
            }

            /* 7. RESULT SCREEN */
            .result-screen { text-align: center; display: none; padding: 20px; }
            .result-screen h2 { color: #fff; font-size: 32px; margin-bottom: 15px; font-family: 'Outfit', sans-serif; }
            .result-screen p { color: #aaa; margin-bottom: 20px; font-size: 16px; line-height: 1.6; }
            .check-animation {
                font-size: 60px; color: var(--accent-cyan); margin-bottom: 30px;
                animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                text-shadow: 0 0 30px var(--accent-cyan);
            }
            @keyframes popIn { 0% { transform: scale(0); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }

            /* 8. FOOTER (FLEXBOX FIX) */
            #footer {
                margin-top: auto;
                width: 100%;
                border-top: 1px solid var(--border-light);
                padding: 40px 0;
                background: transparent;
                position: relative;
            }
            .footer-content {
                display: flex;
                justify-content: space-between;
                align-items: center;
                max-width: 90%;
                margin: 0 auto;
                font-size: 11px;
                color: #555;
            }
            .legal-info { text-align: right; line-height: 1.4; }

            /* 9. MOBILE */
            @media screen and (max-width: 900px) {
                #wrapper { margin-left: 0; }
                .quiz-container { padding: 30px 20px; width: 95%; }
                h2#question { font-size: 20px; }
                .footer-content { flex-direction: column; gap: 20px; text-align: center; }
                .legal-info { text-align: center; }
            }
        </style>
	</head>
	<body class="is-preload">

			<section id="sidebar">
                <div class="sidebar-header">
                    <img src="images/logo.svg" alt="GRWD" class="logo-image">
                    <span class="brand-logo">GRWD</span>
                    <span class="brand-sub">SMART AGENCY</span>
                </div>
				<nav>
					<ul>
						<li><a href="index.html#intro">BACK TO SYSTEM</a></li>
						<li><a href="#" class="active">DIAGNOSTIC MODE</a></li>
					</ul>
				</nav>
			</section>

			<div id="wrapper">

                <section class="quiz-wrapper">
                    
                    <div class="quiz-container">
                        
                        <div class="quiz-body" id="quiz-block">
                            <span id="section-title" class="section-label">System Audit</span>
                            <div class="progress-container"><div class="progress-fill" id="bar"></div></div>
                            
                            <h2 id="question">Initializing...</h2>
                            <span id="type-hint" class="hint"></span>
                            
                            <div id="options"></div>
                            
                            <div class="nav-actions">
                                <button class="btn-action" id="back-btn"><i class="fa-solid fa-arrow-left"></i> Back</button>
                                <button class="btn-action" id="next-btn" disabled>Next Step</button>
                            </div>
                        </div>

                        <div id="result-block" class="result-screen">
                            <div class="check-animation"><i class="fa-solid fa-circle-check"></i></div>
                            <h2>Protocol Complete</h2>
                            <p>Your strategic data has been securely logged.</p>
                            <p>Our engineering team is analyzing your inputs. You will receive a diagnostic roadmap via email within 24 hours.</p>
                            
                            <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                                <a href="index.html" class="button primary small">Return to Command Center</a>
                            </div>
                            
                            <div id="status" style="color:#555; margin-top:20px; font-size: 0.8em; font-family: monospace;">[Status: Encrypting & Sending...]</div>
                        </div>

                    </div>

                </section>

                <footer id="footer">
                    <div class="footer-content">
                        <div class="copyright">&copy; GRWD 2026. All rights reserved.</div>
                        <div class="legal-info">
                            GRWD Agency<br>
                            Warsaw, Poland<br>
                            NIP: [YOUR_NIP_HERE]
                        </div>
                    </div>
                </footer>

			</div>

            <script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

<script>
    // ==========================================
    // ‚öôÔ∏è GRWD QUIZ ENGINE (BRANCHING LOGIC)
    // ==========================================
    const BOT_TOKEN = '8362006099:AAH-V7BaRvOVg3Ufiy0MBUpTPEGjTF7cmGA';
    const CHAT_ID = '1151941643';

    // State Management
    let currentQuestionId = "start";
    let historyStack = []; // For Back Button
    let userAnswers = {}; // Store ID: Answer
    let currentBranch = null; // 'perf', 'brand', 'fract'

    // --- QUIZ DATA STRUCTURE ---
    const quizData = {
        // --- SCREEN 1: SEGMENTATION ---
        "start": {
            screen: "Section 1: Service Selection",
            q: "Which core service area are you primarily interested in right now?",
            type: "radio",
            branch: "root",
            step: 1,
            totalSteps: 6,
            options: [
                { text: "Performance Engine (Fix Funnels / Lead Gen)", next: "perf_q2", setBranch: "perf" },
                { text: "Brand & Authority (Content & Socials)", next: "brand_q2", setBranch: "brand" },
                { text: "Fractional Growth Partner (Strategy & Mgmt)", next: "fract_q2", setBranch: "fract" }
            ]
        },

        // ==========================================
        // üü• BRANCH 1: PERFORMANCE ENGINE
        // ==========================================
        "perf_q2": {
            screen: "Screen 2: Defining the Challenge",
            q: "Which specific challenge within Performance Marketing is most critical?",
            type: "checkbox",
            branch: "perf",
            step: 2,
            totalSteps: 6,
            next: "perf_q3",
            options: [
                { text: "Launching Lead Gen from Scratch / Fixing Chaos" },
                { text: "Regulated Ad-Ops & CAC Reduction" },
                { text: "Turnkey Lead Generation Engineering" },
                { text: "Infrastructure Audit & Setup (Data Transparency)" }
            ]
        },
        "perf_q3": {
            screen: "Screen 3: Financials & Targets",
            q: "What is the primary target segment for your product?",
            type: "radio",
            branch: "perf",
            step: 3,
            totalSteps: 6,
            next: "perf_q4",
            options: [
                { text: "B2B (Enterprise / B2B)" },
                { text: "B2C (Consumer)" },
                { text: "B2B2C (Hybrid)" }
            ]
        },
        "perf_q4": {
            screen: "Screen 3: Financials & Targets",
            q: "Which industry does your business primarily operate in?",
            type: "radio",
            branch: "perf",
            step: 3,
            totalSteps: 6,
            next: "perf_q5",
            options: [
                { text: "SaaS" }, { text: "Robotics" }, { text: "EdTech" },
                { text: "Health Tech" }, { text: "AI / GameDev" },
                { text: "Other", input: true }
            ]
        },
        "perf_q5": {
            screen: "Screen 3: Financials & Targets",
            q: "What is the target Lifetime Value (LTV) of your ideal customer?",
            type: "input_mixed",
            branch: "perf",
            step: 3,
            totalSteps: 6,
            next: "perf_q6",
            options: [
                { text: "LTV Amount:", input: true, placeholder: "e.g. $5,000" },
                { text: "Not yet defined / Need help calculation" }
            ]
        },
        "perf_q6": {
            screen: "Screen 3: Financials & Targets",
            q: "What is your maximum acceptable CAC?",
            type: "input_mixed",
            branch: "perf",
            step: 3,
            totalSteps: 6,
            next: "perf_q7",
            options: [
                { text: "Max CAC:", input: true, placeholder: "e.g. $500" },
                { text: "Not yet defined / Need help calculation" }
            ]
        },
        "perf_q7": {
            screen: "Screen 3: Financials & Targets",
            q: "What is your current monthly budget allocated for Performance Ad Spend?",
            type: "radio",
            branch: "perf",
            step: 3,
            totalSteps: 6,
            next: "perf_q8",
            options: [
                { text: "Less than $5,000" },
                { text: "$5,000 - $15,000" },
                { text: "$15,000 - $50,000" },
                { text: "Over $50,000", input: true }
            ]
        },
        "perf_q8": {
            screen: "Screen 4: Infrastructure",
            q: "Please provide your product website URL for preliminary audit:",
            type: "text_only",
            branch: "perf",
            step: 4,
            totalSteps: 6,
            next: "perf_q9",
            placeholder: "https://yourwebsite.com"
        },
        "perf_q9": {
            screen: "Screen 4: Infrastructure",
            q: "How confident are you in your Product-Market Fit (PMF)?",
            type: "radio",
            branch: "perf",
            step: 4,
            totalSteps: 6,
            next: "perf_q10",
            options: [
                { text: "Proven and Ready (Steady sales, ready to scale)" },
                { text: "Early Proof (Initial sales, needs optimization)" },
                { text: "Testing Phase (Still searching)" }
            ]
        },
        "perf_q10": {
            screen: "Screen 4: Infrastructure",
            q: "Which Paid Media channels are you using or planning to use?",
            type: "checkbox",
            branch: "perf",
            step: 4,
            totalSteps: 6,
            next: "perf_q11",
            options: [
                { text: "Google Ads" }, { text: "Meta Ads" }, { text: "LinkedIn Ads" },
                { text: "TikTok Ads" }, { text: "None (From Scratch)" }, { text: "Other", input: true }
            ]
        },
        "perf_q11": {
            screen: "Screen 4: Infrastructure",
            q: "How well-setup are your analytics and tracking systems?",
            type: "radio",
            branch: "perf",
            step: 4,
            totalSteps: 6,
            next: "perf_q12",
            options: [
                { text: "Total Transparency (GA4/CRM integrated)" },
                { text: "Needs Fixing (Broken funnels)" },
                { text: "Non-existent" }
            ]
        },
        "perf_q12": {
            screen: "Screen 5: Identifying the Leak",
            q: "What is the single biggest 'budget leak' right now?",
            type: "radio",
            branch: "perf",
            step: 5,
            totalSteps: 6,
            next: "contact_name",
            options: [
                { text: "Lack of Marketing Function" },
                { text: "High CAC" },
                { text: "Low Lead Quality" },
                { text: "Ineffective Execution" },
                { text: "Lack of Volume (Can't Scale)" },
                { text: "Lack of Transparency (Data Trust)" }
            ]
        },

        // ==========================================
        // üü¶ BRANCH 2: BRAND & AUTHORITY
        // ==========================================
        "brand_q2": {
            screen: "Screen 2: Defining Focus",
            q: "Which specific area is your primary focus for Brand & Authority?",
            type: "checkbox",
            branch: "brand",
            step: 2,
            totalSteps: 6,
            next: "brand_q3",
            options: [
                { text: "Founder-Led Growth (FLG)" },
                { text: "Strategic Corporate Brand / SMM" },
                { text: "High-Conversion Copywriting & Assets" }
            ]
        },
        "brand_q3": {
            screen: "Screen 3: Strategic Vision",
            q: "What is the primary business goal of this initiative?",
            type: "radio",
            branch: "brand",
            step: 3,
            totalSteps: 6,
            next: "brand_q4",
            options: [
                { text: "Direct Demand Generation" },
                { text: "Building Trust & Credibility" },
                { text: "Establishing Thought Leadership" },
                { text: "Improving Recruiting" }
            ]
        },
        "brand_q4": {
            screen: "Screen 3: Strategic Vision",
            q: "Which industry does your business primarily operate in?",
            type: "radio",
            branch: "brand",
            step: 3,
            totalSteps: 6,
            next: "brand_q5",
            options: [
                { text: "SaaS" }, { text: "Robotics" }, { text: "EdTech" },
                { text: "Health Tech" }, { text: "AI / GameDev" },
                { text: "Other", input: true }
            ]
        },
        "brand_q5": {
            screen: "Screen 3: Strategic Vision",
            q: "Who is the core target audience?",
            type: "radio",
            branch: "brand",
            step: 3,
            totalSteps: 6,
            next: "brand_q6",
            options: [
                { text: "C-Level Executives" },
                { text: "Technical Decision Makers" },
                { text: "VPs / Directors of Sales/Marketing" },
                { text: "Investors / Analysts" },
                { text: "Other", input: true }
            ]
        },
        "brand_q6": {
            screen: "Screen 3: Strategic Vision",
            q: "Competitors benchmarking (Optional):",
            type: "text_only",
            branch: "brand",
            step: 3,
            totalSteps: 6,
            next: "brand_q7",
            placeholder: "Competitor URLs/Names"
        },
        "brand_q7": {
            screen: "Screen 3: Strategic Vision",
            q: "Your website URL for messaging context:",
            type: "text_only",
            branch: "brand",
            step: 3,
            totalSteps: 6,
            next: "brand_q8",
            placeholder: "https://yourwebsite.com"
        },
        "brand_q8": {
            screen: "Screen 4: Readiness",
            q: "Founder's time commitment for content creation?",
            type: "radio",
            branch: "brand",
            step: 4,
            totalSteps: 6,
            next: "brand_q9",
            options: [
                { text: "High Commitment (3-5 hrs/week)" },
                { text: "Low Commitment (High-level ideas only)" },
                { text: "No Commitment (Corporate focus)" }
            ]
        },
        "brand_q9": {
            screen: "Screen 4: Readiness",
            q: "Current status of high-value Brand assets (Case Studies, etc.)?",
            type: "radio",
            branch: "brand",
            step: 4,
            totalSteps: 6,
            next: "brand_q10",
            options: [
                { text: "Well-Developed" },
                { text: "Needs Improvement" },
                { text: "Starting from Scratch" }
            ]
        },
        "brand_q10": {
            screen: "Screen 5: Investment",
            q: "Current resource allocation for Brand Building?",
            type: "radio",
            branch: "brand",
            step: 5,
            totalSteps: 6,
            next: "brand_q11",
            options: [
                { text: "Substantial (Dedicated team/budget)" },
                { text: "Minimal (Side project)" },
                { text: "None (New investment)" }
            ]
        },
        "brand_q11": {
            screen: "Screen 5: Investment",
            q: "Link to profile(s) you wish to scale (Optional):",
            type: "text_only",
            branch: "brand",
            step: 5,
            totalSteps: 6,
            next: "contact_name",
            placeholder: "LinkedIn / Social URL"
        },

        // ==========================================
        // üü™ BRANCH 3: FRACTIONAL PARTNER
        // ==========================================
        "fract_q2": {
            screen: "Screen 2: Strategic Challenge",
            q: "Which strategic problem needs solving first?",
            type: "checkbox",
            branch: "fract",
            step: 2,
            totalSteps: 6,
            next: "fract_q3",
            options: [
                { text: "Building Marketing from Zero" },
                { text: "GTM Strategy & Expansion" },
                { text: "Unit Economics & Profitability" },
                { text: "Pipeline Engineering & Sales Alignment" },
                { text: "Team Audit & Architecture" }
            ]
        },
        "fract_q3": {
            screen: "Screen 3: Business Maturity",
            q: "What is your company's approximate ARR?",
            type: "radio",
            branch: "fract",
            step: 3,
            totalSteps: 6,
            next: "fract_q4",
            options: [
                { text: "Pre-Revenue / <$100k" },
                { text: "$100k - $500k" },
                { text: "$500k - $2M" },
                { text: "$2M - $5M+" },
                { text: "$5M+", input: true }
            ]
        },
        "fract_q4": {
            screen: "Screen 3: Business Maturity",
            q: "Which industry does your business operate in?",
            type: "radio",
            branch: "fract",
            step: 3,
            totalSteps: 6,
            next: "fract_q5",
            options: [
                { text: "SaaS" }, { text: "Robotics" }, { text: "EdTech" },
                { text: "Health Tech" }, { text: "AI / GameDev" },
                { text: "Other", input: true }
            ]
        },
        "fract_q5": {
            screen: "Screen 3: Business Maturity",
            q: "Primary objective for next 12 months?",
            type: "radio",
            branch: "fract",
            step: 3,
            totalSteps: 6,
            next: "fract_q6",
            options: [
                { text: "Secure Funding (Seed/Series A)" },
                { text: "Achieve Product-Market Fit" },
                { text: "Hit Revenue Target ($X ARR)" },
                { text: "New Market Expansion" }
            ]
        },
        "fract_q6": {
            screen: "Screen 3: Business Maturity",
            q: "Why Fractional Partner over full-time hire?",
            type: "radio",
            branch: "fract",
            step: 3,
            totalSteps: 6,
            next: "fract_q7",
            options: [
                { text: "Cost Efficiency" },
                { text: "Speed & Expertise" },
                { text: "Temporary Need / Fix" }
            ]
        },
        "fract_q7": {
            screen: "Screen 3: Business Maturity",
            q: "Website URL for strategic context:",
            type: "text_only",
            branch: "fract",
            step: 3,
            totalSteps: 6,
            next: "fract_q8",
            placeholder: "https://yourwebsite.com"
        },
        "fract_q8": {
            screen: "Screen 4: Data Rigor",
            q: "Confidence in data quality & transparency?",
            type: "radio",
            branch: "fract",
            step: 4,
            totalSteps: 6,
            next: "fract_q9",
            options: [
                { text: "High Confidence (Total Transparency)" },
                { text: "Moderate (Known Gaps)" },
                { text: "Low Confidence (Chaotic)" }
            ]
        },
        "fract_q9": {
            screen: "Screen 4: Data Rigor",
            q: "Primary tracking system?",
            type: "radio",
            branch: "fract",
            step: 4,
            totalSteps: 6,
            next: "fract_q10",
            options: [
                { text: "CRM (HubSpot/SF) + BI" },
                { text: "CRM + Spreadsheets" },
                { text: "Spreadsheets / Manual" },
                { text: "No robust system" }
            ]
        },
        "fract_q10": {
            screen: "Screen 4: Data Rigor",
            q: "Current Growth Team structure?",
            type: "radio",
            branch: "fract",
            step: 4,
            totalSteps: 6,
            next: "fract_q11",
            options: [
                { text: "Dedicated In-house Team" },
                { text: "Hybrid (Internal + Agency)" },
                { text: "Agencies / Freelancers" },
                { text: "None (Founder only)" }
            ]
        },
        "fract_q11": {
            screen: "Screen 5: Expectations",
            q: "When do you need to start?",
            type: "radio",
            branch: "fract",
            step: 5,
            totalSteps: 6,
            next: "fract_q12",
            options: [
                { text: "Immediately (2-4 weeks)" },
                { text: "1-3 months" }
            ]
        },
        "fract_q12": {
            screen: "Screen 5: Expectations",
            q: "Expected minimum duration?",
            type: "radio",
            branch: "fract",
            step: 5,
            totalSteps: 6,
            next: "contact_name",
            options: [
                { text: "3 months (Sprint)" },
                { text: "6 months (Execution)" },
                { text: "9-12 months (Architecture)" }
            ]
        },

        // ==========================================
        // üèÅ SCREEN 6: CONTACT (COMMON)
        // ==========================================
        "contact_name": {
            screen: "Final Screen: Contact Info",
            q: "Your Company Name:",
            type: "text_only",
            branch: "common",
            step: 6,
            totalSteps: 6,
            next: "contact_user",
            placeholder: "Company Name"
        },
        "contact_user": {
            screen: "Final Screen: Contact Info",
            q: "Your Full Name and Title:",
            type: "text_only",
            branch: "common",
            step: 6,
            totalSteps: 6,
            next: "contact_email",
            placeholder: "Name, Title"
        },
        "contact_email": {
            screen: "Final Screen: Contact Info",
            q: "Your Work Email:",
            type: "text_only",
            branch: "common",
            step: 6,
            totalSteps: 6,
            next: "contact_phone",
            placeholder: "name@company.com",
            validation: "email"
        },
        "contact_phone": {
            screen: "Final Screen: Contact Info",
            q: "Your Phone Number:",
            type: "text_only",
            branch: "common",
            step: 6,
            totalSteps: 6,
            next: "FINISH",
            placeholder: "+1 ...",
            validation: "phone"
        }
    };

    // --- DOM Elements ---
    const els = {
        block: document.getElementById('quiz-block'),
        result: document.getElementById('result-block'),
        sectionTitle: document.getElementById('section-title'),
        qText: document.getElementById('question'),
        hint: document.getElementById('type-hint'),
        opts: document.getElementById('options'),
        next: document.getElementById('next-btn'),
        back: document.getElementById('back-btn'),
        bar: document.getElementById('bar'),
        status: document.getElementById('status')
    };

    // --- Validation Regex ---
    const patterns = {
        email: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
        phone: /^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im
    };

    // Initialize
    renderQuestion();

    // --- MAIN RENDER FUNCTION ---
    function renderQuestion() {
        const data = quizData[currentQuestionId];
        if (!data) return finishQuiz();

        // 1. Update UI Text
        els.sectionTitle.innerText = data.screen || "System Audit";
        els.qText.innerText = data.q;
        
        // 2. Hint Logic
        let hintText = "";
        if (data.type === 'checkbox') hintText = "Select one or more options";
        if (data.type === 'text_only') hintText = "Please type your answer below";
        els.hint.innerText = hintText;

        // 3. Progress Bar
        const progress = (data.step / data.totalSteps) * 100;
        els.bar.style.width = `${progress}%`;

        // 4. Back Button Logic
        els.back.style.display = (currentQuestionId === "start") ? "none" : "block";

        // 5. GTM Data Attribute
        let branchCode = currentBranch || "root";
        let screenNum = data.step;
        els.next.setAttribute('data-gtm-id', `quiz_continue_${branchCode}_screen_${screenNum}`);

        // 6. Render Options
        els.opts.innerHTML = '';
        els.next.disabled = true;

        if (data.type === 'text_only') {
            // SINGLE INPUT RENDER
            renderTextInput(data, 0);
        } else {
            // LIST RENDER (Radio/Checkbox)
            els.opts.className = (data.type === 'checkbox') ? 'multiple' : '';
            data.options.forEach((opt, idx) => {
                const div = document.createElement('div');
                div.className = 'option';
                
                // HTML Content
                let html = `<div class="indicator"></div>`;
                if(opt.text) html += `<span>${opt.text}</span>`;

                // If option has input inside (e.g. "Other: ___")
                if(opt.input) {
                    html += `<input type="text" class="custom-input" placeholder="${opt.placeholder || 'Specify...'}" id="opt-input-${idx}">`;
                }

                div.innerHTML = html;
                
                // Click Event
                div.onclick = (e) => {
                    if (e.target.tagName === 'INPUT') return; // Don't trigger if clicking text input
                    handleSelection(div, opt, data.type);
                    if (opt.input) setTimeout(() => document.getElementById(`opt-input-${idx}`).focus(), 50);
                };

                // Input Event (Validation)
                if (opt.input) {
                    const inputEl = div.querySelector('input');
                    inputEl.addEventListener('input', () => {
                        // Auto-select parent option if typing
                        if (!div.classList.contains('selected')) handleSelection(div, opt, data.type);
                        validateStep();
                    });
                }

                els.opts.appendChild(div);
            });
        }
    }

    function renderTextInput(data, idx) {
        const div = document.createElement('div');
        div.className = 'option input-only-option';
        
        let html = `<input type="text" class="custom-input" placeholder="${data.placeholder}" id="text-input-${idx}">`;
        if (data.validation) {
             html += `<div class="error-msg" id="err-${idx}">Invalid format</div>`;
        }
        div.innerHTML = html;
        els.opts.appendChild(div);

        const inputEl = div.querySelector('input');
        inputEl.focus();
        
        // Restore value if navigating back
        if(userAnswers[currentQuestionId]) {
            inputEl.value = userAnswers[currentQuestionId];
            els.next.disabled = false;
        }

        inputEl.addEventListener('input', () => {
            userAnswers[currentQuestionId] = inputEl.value;
            validateStep(data.validation, inputEl.value, inputEl);
        });
    }

    // --- LOGIC HANDLERS ---
    
    function handleSelection(el, opt, type) {
        const isMulti = (type === 'checkbox');
        
        if (isMulti) {
            el.classList.toggle('selected');
        } else {
            // Single choice: clear others
            document.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
            el.classList.add('selected');
        }
        validateStep();
    }

    function validateStep(validationType, val, inputEl) {
        const data = quizData[currentQuestionId];
        let isValid = false;

        if (data.type === 'text_only') {
            // Text Validation
            if (val && val.length > 1) isValid = true;
            if (validationType && patterns[validationType]) {
                if (!patterns[validationType].test(val)) {
                    isValid = false;
                    if(inputEl) inputEl.parentElement.querySelector('.error-msg').style.display = 'block';
                } else {
                    if(inputEl) inputEl.parentElement.querySelector('.error-msg').style.display = 'none';
                }
            }
        } else {
            // Selection Validation
            const selected = document.querySelectorAll('.option.selected');
            if (selected.length > 0) {
                isValid = true;
                // Check inner inputs
                selected.forEach(sel => {
                    const inp = sel.querySelector('input');
                    if (inp && inp.value.trim() === "") isValid = false;
                });
            }
        }

        els.next.disabled = !isValid;
    }

    // --- NAVIGATION ---

    els.next.onclick = () => {
        const data = quizData[currentQuestionId];
        let answerText = [];
        let nextId = data.next;

        if (data.type === 'text_only') {
             answerText.push(userAnswers[currentQuestionId]);
        } else {
            document.querySelectorAll('.option.selected').forEach(el => {
                let text = el.innerText;
                const inp = el.querySelector('input');
                if (inp) text += ": " + inp.value;
                
                // Check if this option changes the branch (Q1)
                const optData = data.options.find(o => el.innerText.includes(o.text));
                if (optData && optData.setBranch) currentBranch = optData.setBranch;
                if (optData && optData.next) nextId = optData.next; // Logic override

                answerText.push(text);
            });
        }

        // Save Answer
        userAnswers[currentQuestionId] = answerText.join(' | ');
        
        // Push History
        historyStack.push(currentQuestionId);

        // Move
        if (nextId === "FINISH") {
            finishQuiz();
        } else {
            currentQuestionId = nextId;
            renderQuestion();
        }
    };

    els.back.onclick = () => {
        if (historyStack.length === 0) return;
        currentQuestionId = historyStack.pop();
        renderQuestion();
        // Note: Restore selections logic is complex, simple re-render clears visual selection but keeps data in userAnswers object.
        // For 'text_only' it restores. For options, user re-selects (simplification for code size).
    };

    // --- FINISH & SEND ---

    function finishQuiz() {
        els.block.style.display = 'none';
        els.result.style.display = 'block';
        
        let msg = `<b>üìä GRWD Audit Submission</b>\n`;
        msg += `‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ\n`;
        msg += `üè∑ <b>Branch:</b> ${currentBranch ? currentBranch.toUpperCase() : 'ROOT'}\n\n`;

        // Iterate through history to preserve order
        historyStack.forEach(qid => {
            const q = quizData[qid];
            const ans = userAnswers[qid];
            msg += `<b>${q.screen}</b>\n`;
            msg += `‚ùì ${q.q}\n`;
            msg += `‚úÖ <i>${ans}</i>\n\n`;
        });

        // Add final step answers (Contact info)
        // (Since contact info were sequential steps, they are already in historyStack)

        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                chat_id: CHAT_ID,
                text: msg,
                parse_mode: "HTML"
            })
        })
        .then(res => {
            if(res.ok) {
                 els.status.innerText = "Data sent via Secure Protocol [Telegram] ‚úÖ";
                 els.status.style.color = "var(--accent-cyan)";
            } else {
                 els.status.innerText = "Connection Error.";
            }
        })
        .catch(err => console.error(err));
    }

</script>

	</body>
</html>
